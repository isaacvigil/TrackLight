---
globs: *.tsx,*.ts
description: WCAG 2.2 accessibility guidelines for React components and pages
---

# WCAG 2.2 Accessibility Guidelines

This project MUST comply with **WCAG 2.2 Level AA** accessibility standards. All UI components and pages must be accessible to users with disabilities.

## Core Principles

### 1. Perceivable - Information must be presentable to users in ways they can perceive

### 2. Operable - Interface components must be operable by all users

### 3. Understandable - Information and operation must be understandable

### 4. Robust - Content must be robust enough for assistive technologies

---

## CRITICAL RULES

### ✅ Rule 1: Text Alternatives (WCAG 1.1.1)

**All non-text content MUST have a text alternative.**

#### Images

```tsx
// ❌ WRONG: Missing alt text
<img src="/logo.png" />

// ✅ CORRECT: Descriptive alt text
<img src="/logo.png" alt="TrackLight job tracking application logo" />

// ✅ CORRECT: Decorative images
<img src="/decoration.png" alt="" role="presentation" />
```

#### Icons (lucide-react)

```tsx
import { Trash2, Edit, Plus } from "lucide-react"

// ❌ WRONG: Icon without label
<button><Trash2 /></button>

// ✅ CORRECT: Icon with aria-label
<button aria-label="Delete application">
  <Trash2 />
</button>

// ✅ CORRECT: Icon with visible text
<button>
  <Trash2 className="mr-2" />
  Delete
</button>

// ✅ CORRECT: Icon with sr-only text
<button>
  <Trash2 />
  <span className="sr-only">Delete application</span>
</button>
```

#### Background Images with Content

```tsx
// ❌ WRONG: Content-bearing background image
<div style={{ backgroundImage: "url(/chart.png)" }} />

// ✅ CORRECT: Use <img> with alt text or provide text alternative
<img src="/chart.png" alt="Monthly application statistics showing 15 applications sent" />
```

---

### ✅ Rule 2: Color Contrast (WCAG 1.4.3)

**Text MUST have sufficient contrast against its background.**

#### Contrast Requirements (WCAG AA)
- **Normal text** (< 18pt or < 14pt bold): **4.5:1** minimum
- **Large text** (≥ 18pt or ≥ 14pt bold): **3:1** minimum
- **UI components** (buttons, inputs, icons): **3:1** minimum

#### Implementation

```tsx
// ❌ WRONG: Low contrast text
<p className="text-gray-400 bg-white">Status: Applied</p> // Contrast: 2.8:1

// ✅ CORRECT: Sufficient contrast
<p className="text-gray-900 bg-white">Status: Applied</p> // Contrast: 7:1

// ❌ WRONG: Low contrast button
<Button className="bg-gray-300 text-gray-400">Submit</Button>

// ✅ CORRECT: Use semantic colors from theme
<Button variant="default">Submit</Button> // Uses CSS variables with proper contrast
```

#### Testing Colors

Before using custom colors:
1. Use a contrast checker (e.g., WebAIM Contrast Checker)
2. Verify against WCAG AA standards (4.5:1 for text)
3. Test with shadcn/ui theme variables (these are pre-validated)

#### shadcn/ui Theme Colors

The project's theme colors in [app/globals.css](mdc:app/globals.css) are designed for accessibility:
- Use `--foreground` on `--background` (high contrast)
- Use `--primary-foreground` on `--primary`
- Use `--muted-foreground` on `--muted`
- Avoid custom color combinations without testing

---

### ✅ Rule 3: Keyboard Accessibility (WCAG 2.1.1, 2.1.2)

**ALL functionality MUST be operable via keyboard.**

#### Interactive Elements

```tsx
// ❌ WRONG: Non-interactive element with click handler
<div onClick={handleDelete}>Delete</div>

// ✅ CORRECT: Use semantic button
<button onClick={handleDelete}>Delete</button>

// ✅ CORRECT: Or shadcn/ui Button
import { Button } from "@/components/ui/button"
<Button onClick={handleDelete}>Delete</Button>
```

#### Custom Interactive Components

```tsx
// ❌ WRONG: Missing keyboard support
<div onClick={handleClick}>Click me</div>

// ✅ CORRECT: Add keyboard handlers and role
<div
  role="button"
  tabIndex={0}
  onClick={handleClick}
  onKeyDown={(e) => {
    if (e.key === "Enter" || e.key === " ") {
      e.preventDefault()
      handleClick()
    }
  }}
>
  Click me
</div>

// ✅ BEST: Use semantic HTML or shadcn/ui components
<button onClick={handleClick}>Click me</button>
```

#### Keyboard Traps (WCAG 2.1.2)

**Users MUST be able to navigate away from any component using only the keyboard.**

```tsx
// ✅ CORRECT: shadcn/ui Dialog handles focus trapping properly
import { Dialog, DialogContent, DialogTrigger } from "@/components/ui/dialog"

<Dialog>
  <DialogTrigger asChild>
    <Button>Open</Button>
  </DialogTrigger>
  <DialogContent>
    {/* Focus is trapped here, but Escape key closes dialog */}
    <p>Content</p>
  </DialogContent>
</Dialog>
```

#### Tab Order

```tsx
// ❌ WRONG: Using positive tabIndex values
<button tabIndex={5}>First</button>
<button tabIndex={1}>Second</button>

// ✅ CORRECT: Let natural DOM order handle tab sequence
<button>First</button>
<button>Second</button>

// ✅ CORRECT: Use tabIndex={0} to include in tab order
<div role="button" tabIndex={0}>Interactive</div>

// ✅ CORRECT: Use tabIndex={-1} to exclude from tab order (but still focusable programmatically)
<div tabIndex={-1}>Not in tab order</div>
```

---

### ✅ Rule 4: Focus Indicators (WCAG 2.4.7)

**Interactive elements MUST have a visible focus indicator.**

#### Implementation

```tsx
// ❌ WRONG: Removing focus outline
<button className="focus:outline-none">Click me</button>

// ✅ CORRECT: Custom focus indicator
<button className="focus:ring-2 focus:ring-primary focus:ring-offset-2">
  Click me
</button>

// ✅ BEST: Use shadcn/ui components (have built-in focus styles)
import { Button } from "@/components/ui/button"
<Button>Click me</Button>
```

#### Global Focus Styles

The project should have global focus styles in [app/globals.css](mdc:app/globals.css):

```css
/* Ensure all focusable elements have visible focus */
*:focus-visible {
  outline: 2px solid hsl(var(--ring));
  outline-offset: 2px;
}

/* Remove outline for mouse users, keep for keyboard users */
*:focus:not(:focus-visible) {
  outline: none;
}
```

---

### ✅ Rule 5: Form Labels and Instructions (WCAG 3.3.2)

**All form inputs MUST have associated labels.**

#### Text Inputs

```tsx
import { Label } from "@/components/ui/label"
import { Input } from "@/components/ui/input"

// ❌ WRONG: Input without label
<Input type="text" name="company" />

// ✅ CORRECT: Label associated with input
<div>
  <Label htmlFor="company">Company Name</Label>
  <Input id="company" type="text" name="company" />
</div>

// ✅ CORRECT: Using aria-label when visual label is not desired
<Input 
  type="text" 
  name="search" 
  aria-label="Search applications"
  placeholder="Search..."
/>
```

#### Form Errors

```tsx
// ❌ WRONG: Error message not associated with input
<Input id="email" type="email" />
<p className="text-red-500">Invalid email</p>

// ✅ CORRECT: Error linked with aria-describedby
<div>
  <Label htmlFor="email">Email</Label>
  <Input 
    id="email" 
    type="email"
    aria-invalid={hasError}
    aria-describedby={hasError ? "email-error" : undefined}
  />
  {hasError && (
    <p id="email-error" className="text-destructive text-sm mt-1">
      Invalid email address
    </p>
  )}
</div>
```

#### Required Fields

```tsx
// ✅ CORRECT: Indicate required fields
<div>
  <Label htmlFor="company">
    Company Name <span className="text-destructive">*</span>
  </Label>
  <Input id="company" type="text" required aria-required="true" />
</div>

// ✅ CORRECT: Or use form description
<div>
  <Label htmlFor="company">Company Name</Label>
  <Input id="company" type="text" required />
  <p className="text-sm text-muted-foreground">Required</p>
</div>
```

---

### ✅ Rule 6: Semantic HTML (WCAG 1.3.1)

**Use semantic HTML elements for their intended purpose.**

#### Headings

```tsx
// ❌ WRONG: Using styled divs for headings
<div className="text-2xl font-bold">Application Tracker</div>

// ✅ CORRECT: Use semantic heading elements
<h1 className="text-2xl font-bold">Application Tracker</h1>

// ✅ CORRECT: Maintain heading hierarchy (h1 → h2 → h3)
<h1>Application Tracker</h1>
<section>
  <h2>Recent Applications</h2>
  <article>
    <h3>Software Engineer at Acme Corp</h3>
  </article>
</section>
```

#### Lists

```tsx
// ❌ WRONG: Using divs for lists
<div>
  <div>Item 1</div>
  <div>Item 2</div>
</div>

// ✅ CORRECT: Use semantic list elements
<ul>
  <li>Item 1</li>
  <li>Item 2</li>
</ul>

// ✅ CORRECT: For ordered lists
<ol>
  <li>First step</li>
  <li>Second step</li>
</ol>
```

#### Navigation

```tsx
// ❌ WRONG: Generic div for navigation
<div>
  <a href="/track">Track</a>
  <a href="/pricing">Pricing</a>
</div>

// ✅ CORRECT: Use nav element
<nav aria-label="Main navigation">
  <ul>
    <li><a href="/track">Track</a></li>
    <li><a href="/pricing">Pricing</a></li>
  </ul>
</nav>
```

#### Buttons vs Links

```tsx
// ❌ WRONG: Link styled as button for navigation
<button onClick={() => router.push("/pricing")}>View Pricing</button>

// ✅ CORRECT: Use Link for navigation
<Link href="/pricing">
  <Button>View Pricing</Button>
</Link>

// ❌ WRONG: Link for actions
<a href="#" onClick={handleDelete}>Delete</a>

// ✅ CORRECT: Use button for actions
<button onClick={handleDelete}>Delete</button>
```

---

### ✅ Rule 7: ARIA Attributes (WCAG 4.1.2)

**Use ARIA attributes to enhance accessibility when semantic HTML is insufficient.**

#### ARIA Roles

```tsx
// ✅ Use role when semantic element doesn't exist
<div role="status" aria-live="polite">
  Application saved successfully
</div>

<div role="alert" aria-live="assertive">
  Error: Failed to save application
</div>

// ✅ Use role for custom widgets
<div role="tablist">
  <button role="tab" aria-selected={isActive}>Tab 1</button>
  <button role="tab" aria-selected={!isActive}>Tab 2</button>
</div>
```

#### ARIA Labels

```tsx
// ✅ aria-label for elements without visible text
<button aria-label="Close dialog">
  <X /> {/* Icon only */}
</button>

// ✅ aria-labelledby to reference another element
<section aria-labelledby="section-title">
  <h2 id="section-title">Recent Applications</h2>
  {/* content */}
</section>

// ✅ aria-describedby for additional context
<input
  type="text"
  aria-describedby="name-help"
/>
<p id="name-help">Enter your full legal name</p>
```

#### ARIA States

```tsx
// ✅ aria-expanded for collapsible content
<button
  aria-expanded={isOpen}
  aria-controls="content-id"
  onClick={() => setIsOpen(!isOpen)}
>
  Toggle Content
</button>
<div id="content-id" hidden={!isOpen}>
  Content
</div>

// ✅ aria-pressed for toggle buttons
<button
  aria-pressed={isActive}
  onClick={() => setIsActive(!isActive)}
>
  {isActive ? "Active" : "Inactive"}
</button>

// ✅ aria-disabled for disabled interactive elements
<button aria-disabled={isDisabled} disabled={isDisabled}>
  Submit
</button>
```

#### ARIA Live Regions

```tsx
// ✅ Announce dynamic content changes to screen readers
<div role="status" aria-live="polite" aria-atomic="true">
  {message}
</div>

// ✅ For urgent messages (use sparingly)
<div role="alert" aria-live="assertive">
  {errorMessage}
</div>
```

---

### ✅ Rule 8: Tables (WCAG 1.3.1)

**Data tables MUST have proper structure and labels.**

```tsx
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "@/components/ui/table"

// ✅ CORRECT: Use shadcn/ui table with caption
<Table>
  <caption className="sr-only">Job applications list</caption>
  <TableHeader>
    <TableRow>
      <TableHead>Company</TableHead>
      <TableHead>Role</TableHead>
      <TableHead>Status</TableHead>
    </TableRow>
  </TableHeader>
  <TableBody>
    <TableRow>
      <TableCell>Acme Corp</TableCell>
      <TableCell>Software Engineer</TableCell>
      <TableCell>Applied</TableCell>
    </TableRow>
  </TableBody>
</Table>
```

---

### ✅ Rule 9: Skip Links (WCAG 2.4.1)

**Provide a way to skip repeated content.**

```tsx
// ✅ Add skip link in layout
// app/layout.tsx
export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        <a
          href="#main-content"
          className="sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 focus:bg-background focus:p-4"
        >
          Skip to main content
        </a>
        <Header />
        <main id="main-content">
          {children}
        </main>
      </body>
    </html>
  )
}
```

---

### ✅ Rule 10: Screen Reader Only Content

**Use the `sr-only` utility class for content that should only be available to screen readers.**

```tsx
// ✅ Add in app/globals.css if not already present
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.focus\:not-sr-only:focus {
  position: static;
  width: auto;
  height: auto;
  padding: initial;
  margin: initial;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

// ✅ Usage
<button>
  <Trash2 />
  <span className="sr-only">Delete application</span>
</button>
```

---

## shadcn/ui Accessibility Features

The project uses shadcn/ui components which have built-in accessibility features. **Always prefer shadcn/ui components over custom implementations.**

### Pre-Accessible Components

These shadcn/ui components already follow accessibility best practices:

- **Button**: Focus indicators, keyboard support
- **Input**: Label association support, aria attributes
- **Dialog**: Focus trapping, keyboard navigation (Escape to close)
- **Dropdown Menu**: Keyboard navigation, ARIA roles
- **Select**: Keyboard navigation, ARIA roles
- **Tabs**: ARIA tablist pattern, keyboard navigation
- **Alert**: Proper ARIA roles and live regions
- **Toast**: ARIA live regions for announcements

### Example: Accessible Dialog

```tsx
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog"
import { Button } from "@/components/ui/button"

// ✅ shadcn/ui Dialog is fully accessible
<Dialog>
  <DialogTrigger asChild>
    <Button>Open Settings</Button>
  </DialogTrigger>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Settings</DialogTitle>
      <DialogDescription>
        Manage your application settings here.
      </DialogDescription>
    </DialogHeader>
    {/* Content */}
  </DialogContent>
</Dialog>
```

---

## Testing Checklist

Before deploying any UI component or page:

- [ ] **Keyboard Navigation**: Can you access all functionality using only Tab, Enter, Escape, and Arrow keys?
- [ ] **Screen Reader**: Test with a screen reader (VoiceOver on Mac, NVDA on Windows)
- [ ] **Color Contrast**: Verify text has 4.5:1 contrast ratio (use WebAIM Contrast Checker)
- [ ] **Focus Indicators**: Are focus indicators visible on all interactive elements?
- [ ] **Alt Text**: Do all images have appropriate alt text?
- [ ] **Form Labels**: Are all form inputs properly labeled?
- [ ] **Semantic HTML**: Are you using appropriate HTML elements (button, nav, main, etc.)?
- [ ] **ARIA**: Are ARIA attributes used correctly (and only when necessary)?
- [ ] **Zoom**: Does the page work at 200% zoom?

---

## Tools and Resources

### Browser Extensions
- **axe DevTools**: Free browser extension for accessibility testing
- **WAVE**: Web accessibility evaluation tool
- **Lighthouse**: Built into Chrome DevTools (Accessibility audit)

### Online Tools
- **WebAIM Contrast Checker**: https://webaim.org/resources/contrastchecker/
- **WAVE**: https://wave.webaim.org/

### Screen Readers
- **macOS**: VoiceOver (⌘+F5)
- **Windows**: NVDA (free), JAWS (paid)
- **Chrome Extension**: ChromeVox

### Documentation
- **WCAG 2.2**: https://www.w3.org/WAI/WCAG22/quickref/
- **ARIA Authoring Practices**: https://www.w3.org/WAI/ARIA/apg/
- **MDN Accessibility**: https://developer.mozilla.org/en-US/docs/Web/Accessibility

---

## Common Violations to Avoid

### ❌ Violations

1. **Missing alt text on images**
2. **Low color contrast** (< 4.5:1 for text)
3. **Non-semantic HTML** (divs instead of buttons)
4. **Missing form labels**
5. **No keyboard support** for interactive elements
6. **No focus indicators** or removed outlines
7. **Using color alone** to convey information
8. **Improper ARIA usage** (overuse or incorrect implementation)
9. **Missing heading hierarchy** (skipping from h1 to h3)
10. **Inaccessible custom components** (not using shadcn/ui)

---

## Enforcement

**All Pull Requests and code changes MUST:**
1. Pass automated accessibility tests (axe, Lighthouse)
2. Be keyboard navigable
3. Have proper ARIA attributes where needed
4. Use semantic HTML
5. Have sufficient color contrast
6. Include text alternatives for non-text content
7. Use shadcn/ui components (which are pre-accessible)

**If creating custom components (rare), you MUST:**
1. Implement keyboard navigation
2. Add proper ARIA attributes
3. Ensure focus management
4. Test with screen readers
5. Verify color contrast

**Default to shadcn/ui components to avoid accessibility issues.**
